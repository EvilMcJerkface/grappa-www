<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Grappa: Grappa::impl::StealQueue&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Grappa
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_grappa_1_1impl_1_1_steal_queue.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_grappa_1_1impl_1_1_steal_queue-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Grappa::impl::StealQueue&lt; T &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Bounded queue that knows how to share elements with other queues by work stealing.  
 <a href="class_grappa_1_1impl_1_1_steal_queue.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a56c879ef0b066c3177e24e2a125609df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a56c879ef0b066c3177e24e2a125609df">activate</a> (uint64_t numEle)</td></tr>
<tr class="separator:a56c879ef0b066c3177e24e2a125609df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff0aa0106c64843dd12e6d6cc4df0976"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#aff0aa0106c64843dd12e6d6cc4df0976">StealQueue</a> ()</td></tr>
<tr class="memdesc:aff0aa0106c64843dd12e6d6cc4df0976"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor allocates uninitialized queue.  <a href="#aff0aa0106c64843dd12e6d6cc4df0976">More...</a><br/></td></tr>
<tr class="separator:aff0aa0106c64843dd12e6d6cc4df0976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a293e846e85fd1f9c96de1ebaf516d206"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a293e846e85fd1f9c96de1ebaf516d206">mkEmpty</a> ()</td></tr>
<tr class="memdesc:a293e846e85fd1f9c96de1ebaf516d206"><td class="mdescLeft">&#160;</td><td class="mdescRight">set queue to empty  <a href="#a293e846e85fd1f9c96de1ebaf516d206">More...</a><br/></td></tr>
<tr class="separator:a293e846e85fd1f9c96de1ebaf516d206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4115ee80e9a261d6846ba14e169e58ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a4115ee80e9a261d6846ba14e169e58ec">push</a> (T c)</td></tr>
<tr class="memdesc:a4115ee80e9a261d6846ba14e169e58ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push onto top of local stack.  <a href="#a4115ee80e9a261d6846ba14e169e58ec">More...</a><br/></td></tr>
<tr class="separator:a4115ee80e9a261d6846ba14e169e58ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c37f38a5ce70d39af578324c53d176"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a16c37f38a5ce70d39af578324c53d176">peek</a> ()</td></tr>
<tr class="memdesc:a16c37f38a5ce70d39af578324c53d176"><td class="mdescLeft">&#160;</td><td class="mdescRight">get top element  <a href="#a16c37f38a5ce70d39af578324c53d176">More...</a><br/></td></tr>
<tr class="separator:a16c37f38a5ce70d39af578324c53d176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a04e75fe7bd44da714890c749eec7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#ae8a04e75fe7bd44da714890c749eec7e">pop</a> ()</td></tr>
<tr class="memdesc:ae8a04e75fe7bd44da714890c749eec7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">local pop  <a href="#ae8a04e75fe7bd44da714890c749eec7e">More...</a><br/></td></tr>
<tr class="separator:ae8a04e75fe7bd44da714890c749eec7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b5f5ce13635e3326d0b1f0d646d0ccc"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a2b5f5ce13635e3326d0b1f0d646d0ccc">topPosn</a> () const </td></tr>
<tr class="memdesc:a2b5f5ce13635e3326d0b1f0d646d0ccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">local top position: stack index of top element  <a href="#a2b5f5ce13635e3326d0b1f0d646d0ccc">More...</a><br/></td></tr>
<tr class="separator:a2b5f5ce13635e3326d0b1f0d646d0ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14e101ed4ad2c0c4c2fb8faee221e9b"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#af14e101ed4ad2c0c4c2fb8faee221e9b">depth</a> () const </td></tr>
<tr class="memdesc:af14e101ed4ad2c0c4c2fb8faee221e9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of elements in the queue  <a href="#af14e101ed4ad2c0c4c2fb8faee221e9b">More...</a><br/></td></tr>
<tr class="separator:af14e101ed4ad2c0c4c2fb8faee221e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae709fa268d314202d60a7ef7fdaa310d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#ae709fa268d314202d60a7ef7fdaa310d">release</a> (int k)</td></tr>
<tr class="separator:ae709fa268d314202d60a7ef7fdaa310d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae04e945de77cc70a682d207be0dd6ffe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#ae04e945de77cc70a682d207be0dd6ffe">acquire</a> (int k)</td></tr>
<tr class="separator:ae04e945de77cc70a682d207be0dd6ffe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a027d48b0c99d31f7cad8676ab6e36"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#aa5a027d48b0c99d31f7cad8676ab6e36">get_nNodes</a> ()</td></tr>
<tr class="separator:aa5a027d48b0c99d31f7cad8676ab6e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8b268e701efbe5798a3d17bc71055c"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a4e8b268e701efbe5798a3d17bc71055c">steal_locally</a> (<a class="el" href="namespace_grappa_1_1impl.html#aed652828378476dae45958142f67fec4">Core</a> victim, int64_t max_steal)</td></tr>
<tr class="memdesc:a4e8b268e701efbe5798a3d17bc71055c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Steal elements from the StealQueue&lt;T&gt; located at the victim Core.  <a href="#a4e8b268e701efbe5798a3d17bc71055c">More...</a><br/></td></tr>
<tr class="separator:a4e8b268e701efbe5798a3d17bc71055c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a35e858965e9fc272c3b34790b9a0a52f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a35e858965e9fc272c3b34790b9a0a52f">registerAddress</a> (<a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a>&lt; T &gt; *addr)</td></tr>
<tr class="memdesc:a35e858965e9fc272c3b34790b9a0a52f"><td class="mdescLeft">&#160;</td><td class="mdescRight">register local address of remote steal queues  <a href="#a35e858965e9fc272c3b34790b9a0a52f">More...</a><br/></td></tr>
<tr class="separator:a35e858965e9fc272c3b34790b9a0a52f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:acd818ed6a494ef2b62684a6e563d5f97"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#acd818ed6a494ef2b62684a6e563d5f97">steal_queue</a></td></tr>
<tr class="memdesc:acd818ed6a494ef2b62684a6e563d5f97"><td class="mdescLeft">&#160;</td><td class="mdescRight">template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::workShareReplyFewer( int amountDenied ) { // restore denied work CHECK( bottom &gt;= amountDenied ) &lt;&lt; "bottom = " &lt;&lt; bottom &lt;&lt; " amountDenied = " &lt;&lt; amountDenied;  <a href="#acd818ed6a494ef2b62684a6e563d5f97">More...</a><br/></td></tr>
<tr class="separator:acd818ed6a494ef2b62684a6e563d5f97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd949f660c25e9798660fc39a79e18f"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#aecd949f660c25e9798660fc39a79e18f">bufsize</a> = 110</td></tr>
<tr class="separator:aecd949f660c25e9798660fc39a79e18f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a82ea9ce90b858d36af310a36a1a35740"><td class="memTemplParams" colspan="2">template&lt;typename U &gt; </td></tr>
<tr class="memitem:a82ea9ce90b858d36af310a36a1a35740"><td class="memTemplItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#a82ea9ce90b858d36af310a36a1a35740">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a>&lt; U &gt; &amp;sq)</td></tr>
<tr class="separator:a82ea9ce90b858d36af310a36a1a35740"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T&gt;<br/>
class Grappa::impl::StealQueue&lt; T &gt;</h3>

<p>Bounded queue that knows how to share elements with other queues by work stealing. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>type of elements </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00128">128</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aff0aa0106c64843dd12e6d6cc4df0976"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::<a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor allocates uninitialized queue. </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00231">231</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae04e945de77cc70a682d207be0dd6ffe"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::acquire </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a56c879ef0b066c3177e24e2a125609df"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::activate </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>numEle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00214">214</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="af14e101ed4ad2c0c4c2fb8faee221e9b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::depth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>number of elements in the queue </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00319">319</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa5a027d48b0c99d31f7cad8676ab6e36"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::get_nNodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00252">252</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a293e846e85fd1f9c96de1ebaf516d206"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::mkEmpty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set queue to empty </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00325">325</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a16c37f38a5ce70d39af578324c53d176"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::peek </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get top element </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00296">296</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae8a04e75fe7bd44da714890c749eec7e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::pop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>local pop </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00303">303</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4115ee80e9a261d6846ba14e169e58ec"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::push </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Push onto top of local stack. </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00281">281</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a35e858965e9fc272c3b34790b9a0a52f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::registerAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>register local address of remote steal queues </p>

</div>
</div>
<a class="anchor" id="ae709fa268d314202d60a7ef7fdaa310d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::release </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4e8b268e701efbe5798a3d17bc71055c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::steal_locally </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_grappa_1_1impl.html#aed652828378476dae45958142f67fec4">Core</a>&#160;</td>
          <td class="paramname"><em>victim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>max_steal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Steal elements from the StealQueue&lt;T&gt; located at the victim Core. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>type of the queue elements </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">victim</td><td>target Core to steal from </td></tr>
    <tr><td class="paramname">max_steal</td><td>max steal amount</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>amount stolen </dd></dl>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00366">366</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2b5f5ce13635e3326d0b1f0d646d0ccc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::topPosn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>local top position: stack index of top element </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00332">332</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a82ea9ce90b858d36af310a36a1a35740"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<div class="memtemplate">
template&lt;typename U &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a>&lt; U &gt; &amp;&#160;</td>
          <td class="paramname"><em>sq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aecd949f660c25e9798660fc39a79e18f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::bufsize = 110</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00262">262</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="acd818ed6a494ef2b62684a6e563d5f97"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">template <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a>&lt; <a class="el" href="class_grappa_1_1impl_1_1_task.html">Task</a> &gt; <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">Grappa::impl::StealQueue</a>&lt; T &gt;::steal_queue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::workShareReplyFewer( int amountDenied ) { // restore denied work CHECK( bottom &gt;= amountDenied ) &lt;&lt; "bottom = " &lt;&lt; bottom &lt;&lt; " amountDenied = " &lt;&lt; amountDenied; </p>
<p>template GlobalQueue&lt;Task&gt; <a class="el" href="class_grappa_1_1impl_1_1_global_queue.html#a8dfd8554ce1c7410335770bc819f446a">GlobalQueue&lt;Task&gt;::global_queue</a>;</p>
<p>// invariant that bottom does not change CHECK( bottom == local_push_old_bottom+local_push_amount );</p>
<p>uint64_t prev_bottom = bottom; bottom -= amountDenied;</p>
<p>#if DEBUG T * xfer_start = stack + local_push_old_bottom;</p>
<p>// 0 out the transfered stuff (to detect errors) memset(xfer_start, 0, (local_push_amount-amountDenied)*sizeof( T ) ); #endif</p>
<p>DVLOG(5) &lt;&lt; "replyFewer: " &lt;&lt; amountDenied &lt;&lt; " denied; moving bottom " &lt;&lt; prev_bottom &lt;&lt; " -&gt; " &lt;&lt; bottom &lt;&lt; " " &lt;&lt; *this;</p>
<p>local_push_replyfewer = true; local_push_retVal = amountDenied; if ( push_waiter != NULL ) { global_scheduler.thread_wake( push_waiter ); push_waiter = NULL; }</p>
<p>}</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::workShareReplyGreater( int amountGiven, T * data ) { // restore all pushed work CHECK( bottom &gt;= local_push_amount );</p>
<p>// invariant that bottom does not change CHECK( bottom == local_push_old_bottom+local_push_amount );</p>
<p>uint64_t prev_bottom = bottom; bottom -= local_push_amount;</p>
<p>// copy received work onto stack CHECK( top + amountGiven &lt; stackSize ) &lt;&lt; "steal reply: overflow (top:" &lt;&lt; top &lt;&lt; " stackSize:" &lt;&lt; stackSize &lt;&lt; " amt:" &lt;&lt; amountGiven &lt;&lt; ")"; memcpy(&amp;stack[top], data, amountGiven * sizeof(T));</p>
<p>top += amountGiven;</p>
<p>DVLOG(5) &lt;&lt; "replyGreater: " &lt;&lt; amountGiven &lt;&lt; " given; moving bottom " &lt;&lt; prev_bottom &lt;&lt; " -&gt; " &lt;&lt; bottom &lt;&lt; " " &lt;&lt; *this;</p>
<p>local_push_replyfewer = false; local_push_retVal = amountGiven; if ( push_waiter != NULL ) { global_scheduler.thread_wake( push_waiter ); push_waiter = NULL; } }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::workShareReplyFewer_am ( workShareReply_args * args, size_t args_size, void * payload, size_t payload_size ) { steal_queue.workShareReplyFewer( args-&gt;amount ); }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::workShareReplyGreater_am ( workShareReply_args * args, size_t args_size, void * payload, size_t payload_size ) { CHECK( payload_size == args-&gt;amount * sizeof(T) );</p>
<p>steal_queue.workShareReplyGreater( args-&gt;amount, static_cast&lt;T*&gt;( payload ) ); }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::workShareRequest_am ( workShareRequest_args * args, size_t args_size, void * payload, size_t payload_size ) { CHECK( payload_size == args-&gt;amountPushed * sizeof(T) );</p>
<p>steal_queue.workShareRequest( args-&gt;queueSize, args-&gt;from, static_cast&lt;T*&gt;( payload ), args-&gt;amountPushed ); }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::workShareRequest( uint64_t remoteSize, Core from, T * data, int num ) { uint64_t mySize = <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#af14e101ed4ad2c0c4c2fb8faee221e9b" title="number of elements in the queue ">depth()</a>;</p>
<p>reclaimSpace();</p>
<p>int64_t diff = mySize - remoteSize; if ( diff &gt; 0 ) { // we have more elements, so ignore the incoming data and send some</p>
<p>// cannot violate that bottom is constant during pendingWorkShare=true if ( pendingWorkShare ) { // reply that all work is denied, none sent workShareReply_args reply_args = { num }; Grappa_call_on ( from, &amp;StealQueue&lt;T&gt;::workShareReplyFewer_am, &amp;reply_args ); // FIXME: call_on deprecated size_t msg_size = Grappa_sizeof_message( &amp;reply_args ); StealMetrics::record_workshare_reply_nack( msg_size ); return; }</p>
<p>// no pendingWorkShare, so proceed uint64_t balanceAmount = ((mySize+remoteSize)/2) - remoteSize; int amountToSend = <a class="el" href="_steal_queue_8hpp.html#a4d6b570c4898bbf4654a85762a84c1eb">MIN_INT( balanceAmount, FLAGS_chunk_size )</a>; // restrict to chunk size; TODO: don't use flag CHECK( amountToSend &gt;= 0 ) &lt;&lt; "amountToSend = " &lt;&lt; amountToSend;</p>
<p>uint64_t origBottom = bottom; uint64_t origTop = top;</p>
<p>// reserve a chunk bottom = bottom + amountToSend;</p>
<p>T * xfer_stackBase = stack; T * xfer_start = xfer_stackBase + origBottom;</p>
<p>DVLOG(5) &lt;&lt; "from=" &lt;&lt; from &lt;&lt; ", size=" &lt;&lt; mySize &lt;&lt; " vs " &lt;&lt; remoteSize &lt;&lt; ", received " &lt;&lt; num &lt;&lt; ", sending " &lt;&lt; amountToSend;</p>
<p>// reply with number of elements being sent workShareReply_args reply_args = { amountToSend }; Grappa_call_on( from, &amp;StealQueue&lt;T&gt;::workShareReplyGreater_am, &amp;reply_args, sizeof(reply_args), xfer_start, amountToSend * sizeof(T) ); // FIXME: call_on deprecated size_t msg_size = Grappa_sizeof_message( &amp;reply_args, sizeof(reply_args), xfer_start, amountToSend * sizeof(T) ); StealMetrics::record_workshare_reply( msg_size, false, num, num, amountToSend );</p>
<p>#if DEBUG // 0 out the transfered stuff (to detect errors) memset(xfer_start, 0, amountToSend*sizeof( T ) ); #endif } else { // we have fewer elements, so take it and reply that we had fewer elements in the queue</p>
<p>uint64_t balanceAmount = ((mySize+remoteSize)/2) - mySize; int amountToTake = <a class="el" href="_steal_queue_8hpp.html#a4d6b570c4898bbf4654a85762a84c1eb">MIN_INT( balanceAmount, num )</a>; CHECK( amountToTake &gt;= 0 ) &lt;&lt; "amountToTake = " &lt;&lt; amountToTake;</p>
<p>DVLOG(5) &lt;&lt; "from=" &lt;&lt; from &lt;&lt; ", size=" &lt;&lt; mySize &lt;&lt; " vs " &lt;&lt; remoteSize &lt;&lt; ", received " &lt;&lt; num &lt;&lt; ", taking " &lt;&lt; amountToTake;</p>
<p>// TODO consider below bottom CHECK( top + amountToTake &lt; stackSize ); memcpy(&amp;stack[top], data, amountToTake * sizeof(T) ); top += amountToTake;</p>
<p>// reply with number of elements denied int denied = num - amountToTake; workShareReply_args reply_args = { denied }; Grappa_call_on ( from, &amp;StealQueue&lt;T&gt;::workShareReplyFewer_am, &amp;reply_args ); // FIXME: call_on deprecated size_t msg_size = Grappa_sizeof_message( &amp;reply_args ); StealMetrics::record_workshare_reply( msg_size, true, num, denied, 0 ); } } template &lt;typename t&gt;=""&gt; uint64_t StealQueue&lt;T&gt;::pull_global() { ChunkInfo&lt;T&gt; data_ptr; global_queue_pull&lt;T&gt;( &amp;data_ptr );</p>
<p>Signaler signal; pull_global_data_args&lt;T&gt; args; args.signal = make_global( &amp;signal ); args.chunk = data_ptr; Grappa_call_on( data_ptr.base.core(), pull_global_data_request_g_am, &amp;args ); // FIXME: call_on deprecated size_t msg_size = Grappa_sizeof_message( &amp;args ); <a class="el" href="class_grappa_1_1impl_1_1_steal_metrics.html#af59d46a472aa1c41625625b4ed72c5a8">StealMetrics::record_globalq_data_pull_request</a>( msg_size, data_ptr.amount ); <a class="el" href="group___synchronization.html#ga0e49ee2c2ae50e793e427b0fcfa842f9" title="Proxy for remote ConditionVariable manipulation. ">signal.wait()</a>;</p>
<p>return data_ptr.amount; }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::pull_global_data_request_g_am( pull_global_data_args&lt;T&gt; * args, size_t args_size, void * payload, size_t payload_size ) { steal_queue.pull_global_data_request( args ); }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::pull_global_data_request( pull_global_data_args&lt;T&gt; * args ) { CHECK( numPendingElements &gt;= args-&gt;chunk.amount ) &lt;&lt; "trying to take more than released number of elements";</p>
<p>T * chunk_base = args-&gt;chunk.base.pointer(); CHECK( chunk_base &gt;= stack &amp;&amp; chunk_base &lt; stack+stackSize ) &lt;&lt; "chunk base pointer falls outside of the stack range";</p>
<p>CHECK( chunk_base + args-&gt;chunk.amount &lt;= stack+bottom ) &lt;&lt; "chunk overlaps the local part of the stack";</p>
<p>Grappa_call_on_x( args-&gt;signal.core(), pull_global_data_reply_g_am, &amp;(args-&gt;signal), sizeof(args-&gt;signal), chunk_base, args-&gt;chunk.amount * sizeof(T) ); // FIXME: call_on deprecated size_t msg_size = Grappa_sizeof_message( &amp;(args-&gt;signal), sizeof(args-&gt;signal), chunk_base, args-&gt;chunk.amount * sizeof(T) ); <a class="el" href="class_grappa_1_1impl_1_1_steal_metrics.html#a587de4631ab1ff565601272628b6cc15">StealMetrics::record_globalq_data_pull_reply</a>( msg_size, args-&gt;chunk.amount );</p>
<p>numPendingElements -= args-&gt;chunk.amount;</p>
<p>#if DEBUG // 0 out the transfered elements (to detect errors) memset( chunk_base, 0, args-&gt;chunk.amount*sizeof(T) ); #endif</p>
<p>// in case all pending elements are now gone, try to reclaim space reclaimSpace(); }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::pull_global_data_reply_g_am( GlobalAddress&lt; Signaler &gt; * signal, size_t arg_size, T * payload, size_t payload_size ) { steal_queue.pull_global_data_reply( signal, payload, payload_size ); }</p>
<p>template &lt;typename t&gt;=""&gt; void StealQueue&lt;T&gt;::pull_global_data_reply( GlobalAddress&lt; Signaler &gt; * signal, T * received_elements, size_t elements_size ) { uint64_t num_elements = elements_size / sizeof(T);</p>
<p>CHECK( top + num_elements &lt; stackSize ) &lt;&lt; "pull_global_data reply: overflow (top:" &lt;&lt; top &lt;&lt; " stackSize:" &lt;&lt; stackSize &lt;&lt; " amt:" &lt;&lt; num_elements &lt;&lt; ")";</p>
<p>// TODO bottom better memcpy( &amp;stack[top], received_elements, elements_size ); top += num_elements;</p>
<p>// wake the thread that initiated the pull signal-&gt;pointer()-&gt;<a class="el" href="group___synchronization.html#gabcf3b681a173156001dc47e12c081de9">signal()</a>; }</p>
<p>template &lt;typename t&gt;=""&gt; bool StealQueue&lt;T&gt;::push_global( uint64_t amount ) { CHECK( !pendingGlobalPush ) &lt;&lt; "multiple outstanding pushes not allowed"; // due to reclaiming unaccepted elements pendingGlobalPush = true;</p>
<p>// check the amount is legal CHECK( amount &lt;= <a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html#af14e101ed4ad2c0c4c2fb8faee221e9b" title="number of elements in the queue ">depth()</a> ) &lt;&lt; "trying to release more elements than are in the queue"; CHECK( amount &lt;= bufsize ) &lt;&lt; "Only support single-packet transfers";</p>
<p>// release elements uint64_t orig_bottom = bottom; bottom += amount; numPendingElements += amount;</p>
<p>// push chunk information to the global queue. // this is a blocking/yielding operation bool accepted = global_queue_push&lt;T&gt;( make_global( &amp;stack[orig_bottom] ), amount );</p>
<p>if ( !accepted ) { // reclaim unaacepted elements bottom = orig_bottom; numPendingElements -= amount; }</p>
<p>pendingGlobalPush = false;</p>
<p>return accepted; }</p>
<p>template void global_queue_pull&lt;Task&gt;( ChunkInfo&lt;Task&gt; * result ); template bool global_queue_push&lt;Task&gt;( GlobalAddress&lt;Task&gt; chunk_base, uint64_t chunk_amount ); </p>

<p>Definition at line <a class="el" href="_steal_queue_8hpp_source.html#l00212">212</a> of file <a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_steal_queue_8hpp_source.html">StealQueue.hpp</a></li>
<li><a class="el" href="_task_8cpp_source.html">Task.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_grappa.html">Grappa</a></li><li class="navelem"><a class="el" href="namespace_grappa_1_1impl.html">impl</a></li><li class="navelem"><a class="el" href="class_grappa_1_1impl_1_1_steal_queue.html">StealQueue</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
